<html>
<head>
    <script src="scripts/textToWordMap.js"></script>
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script src="https://rawgit.com/jasondavies/d3-cloud/master/build/d3.layout.cloud.js"></script>

    <script>
window.onload = function() {
    console.log("hello world main");
  var words = text2wordmap("(JR) Okay, okay. Calm down. I'll answer. First: I'm jadedResearcher, the Waste of Mind. Uhh, that's about as--as--as much as I can answer. No names, no faces, that kinda thing. Um, moving on, uh... (Sighs) Well, uh... (Laughs) This session is really fucked. Um, there's this thing called corruption. Um, it came from the base of the tree and it makes people weird. Um, I don't wanna be here all day telling you the specifics it's just don't--don't get too close to any of them, right? It's contagious. (Laughs) Don't get kink--don't get too close to corrupt--corrupt trolls. Um, oh, er, there's this thing called--er, your third question is there's this thing called god-tier, right? If you're god-tier you can survive just about anything unless it would make a good story if you died. Uh, the best way to go about, uh, getting around that is to just only do stupid shit. I know I do... Can I have my sandwich now?");
    console.log(words);
    startWords(words);
    startWords(words);
  }

  function startWords(words){
      var width = 850;
      var height = 300;
      var vis = document.getElementById("wordcloud");
      var layout = d3.layout.cloud().size([width, height])
        .words(words)
        .padding(2)
        .rotate(function() { return (~~(Math.random() * 6) - 3) * 20; })
        .font("Impact")
        .fontSize(function(d) { return d.size; })
        .spiral("archimedean")
        .on("end", draw);

      layout.start();
  }

  function draw(words) {
    var width = 850;
  var height = 300;
      var color = d3.scale.category20();
  //var color = d3.scale.linear().domain([0,1,2,3,4,5,6,10,15,20,100])
  //.range(["#F00", "#E00", "#D00", "#C00", "#B00", "#A00", "#900", "#800", "#700", "#600", "#500", "#400"]);

    d3.select("#wordcloud").append("svg")
      .style("width", "100%")
      .style("height", height+"px")
      .attr("viewBox", "0 0 " + width + " " + height)
      .attr("preserveAspectRatio", "xMidYMin meet")
      .append("g")
      .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")")
      .selectAll("text")
      .data(words).enter().append("text")
      .style("font-size", function(d) { return d.size + "px"; })
      .style("font-family", "Impact")
      .style("fill", function(d, i) { return color(i); })
      .attr("text-anchor", "middle")
      .attr("transform", function(d) {
        return "translate(" + [d.x, d.y] + ")rotate(" + d.rotate + ")";
      })
      .text(function(d) { return d.text; })
    ;
 }


    </script>
</head>
<body>

<div id = 'wordcloud'>
    http://jsbin.com/kiwojayoye/1/edit?html,js,output
</div>
</body>
</html>